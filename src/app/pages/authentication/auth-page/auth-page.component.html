<div class="body w-screen h-screen flex justify-center items-center">
  <div class="container" [class.active]="isActive">
    <div class="form-box login">
      <form (submit)="handleLogin()">
        <h1>Login</h1>
        <div class="input-box">
          <input
            type="text"
            placeholder="Username"
            required
            [(ngModel)]="LoginData.username"
            name="username"
          />
          <span nz-icon nzType="user" nzTheme="outline"></span>
        </div>
        <div class="input-box">
          <input
            type="password"
            placeholder="Password"
            required
            [(ngModel)]="LoginData.password"
            name="password"
          />
          <span nz-icon nzType="lock" nzTheme="outline"></span>
        </div>
        <button type="submit" class="btn" nz-button nzType="primary">
          Login
        </button>

        <p>or login with social platforms</p>
        <div class="social-icons">
          <a href="#"
            ><span nz-icon nzType="google" nzTheme="outline"></span
          ></a>
          <a href="#"
            ><span nz-icon nzType="facebook" nzTheme="outline"></span
          ></a>
          <a href="#"
            ><span nz-icon nzType="github" nzTheme="outline"></span
          ></a>
          <a href="#"
            ><span nz-icon nzType="linkedin" nzTheme="outline"></span
          ></a>
        </div>
      </form>
    </div>

    <div class="form-box register">
      <form (submit)="submitRegisterForm()" #registerFormRef="ngForm">
        <h1>Registration</h1>
        <div class="input-box">
          <input
            type="text"
            placeholder="Username"
            required
            [(ngModel)]="registerForm.username"
            name="username"
          />
          <span nz-icon nzType="user" nzTheme="outline"></span>
        </div>
        <!-- <div class="input-box">
          <input
            type="text"
            name="full_name"
            placeholder="full name"
            required
            [(ngModel)]="registerForm.full_name"
          />
          <span nz-icon nzType="borderless-table" nzTheme="outline"></span>
        </div> -->
        <div class="input-box">
          <input
            type="email"
            name="email"
            placeholder="Email"
            required
            [(ngModel)]="registerForm.email"
          />
          <span nz-icon nzType="mail" nzTheme="outline"></span>
        </div>
        <div class="input-box">
          <input
            type="password"
            name="password"
            placeholder="Password"
            required
            [(ngModel)]="registerForm.password"
          />
          <span nz-icon nzType="lock" nzTheme="outline"></span>
        </div>
        <div class="flex gap-x-2">
       <button type="button" class="btn" nz-button nzType="primary" (click)="addProfile()">
  Add profile pic
</button>
          <button type="submit" class="btn" nz-button nzType="primary">
            Register
          </button>
        </div>
      </form>
    </div>

    <!-- Add Picture Modal -->
    <app-modal
      [modalId]="'addProfilePicture'"
      [title]="'Profile Picture'"
      [confirmBtnText]="'Save Changes'"
      (confirmed)="profilePicSave($event)"
    >
      <div class="flex flex-col gap-6 items-center p-6">
        <!-- Hidden File Input -->
        <input
          hidden
          type="file"
          accept="image/png,image/jpeg,image/webp"
          #fileInput
          (change)="onCustomFileSelect($event)"
        />

        <!-- Upload Area -->
        <div class="relative group">
          <!-- Avatar Preview/Upload -->
          <div
            class="flex justify-center items-center w-48 h-48 rounded-full border-2 border-dashed border-gray-200 hover:border-indigo-400 bg-gradient-to-br from-gray-50 to-gray-100 cursor-pointer transition-all duration-300 overflow-hidden shadow-sm hover:shadow-md"
            (click)="fileInput.click()"
          >
            @if (loading) {
            <div class="flex flex-col items-center">
              <svg
                class="animate-spin h-8 w-8 text-indigo-500 mb-2"
                viewBox="0 0 24 24"
              >
                <circle
                  class="opacity-25"
                  cx="12"
                  cy="12"
                  r="10"
                  stroke="currentColor"
                  stroke-width="4"
                ></circle>
                <path
                  class="opacity-75"
                  fill="currentColor"
                  d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                ></path>
              </svg>
              <span class="text-sm text-gray-600">Processing...</span>
            </div>
            } @else if (avatarUrl) {
            <img
              [src]="avatarUrl"
              class="object-cover w-full h-full transition-transform duration-300 group-hover:scale-105"
              alt="Profile preview"
            />
            <div
              class="absolute inset-0 w-full h-full rounded-full bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center"
            >
              <div
                class="bg-white w-10 h-10 flex justify-center items-center rounded-full shadow-xl"
              >
                <svg
                  class="w-8 h-8 text-indigo-600"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"
                  ></path>
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"
                  ></path>
                </svg>
              </div>
            </div>

            } @else {
            <div
              class="text-center p-4 flex flex-col justify-center items-center gap-2"
            >
              <div
                class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-indigo-100 mb-3"
              >
                <svg
                  class="h-6 w-6 text-indigo-600"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"
                  ></path>
                </svg>
              </div>
              <p class="text-sm text-gray-600">
                <span class="font-medium text-indigo-600">Click to upload</span>
              </p>
              <p class="text-xs text-gray-400 mt-1">SVG, PNG, JPG (max. 5MB)</p>
            </div>
            }
          </div>

          <!-- Remove button (only shown when image exists) -->
          @if (avatarUrl && !loading) {
          <button
            (click)="removeAvatar()"
            class="absolute -bottom-4 left-1/2 transform -translate-x-1/2 flex items-center justify-center gap-1 w-10 h-10 bg-white text-red-500 hover:text-white hover:bg-red-500 rounded-full shadow-md transition-all duration-200 border border-red-100 hover:border-red-500"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
              ></path>
            </svg>
          </button>
          }
        </div>

        <!-- Editing Tools (shown when image exists) -->
        @if (avatarUrl && !loading) {
        <div class="flex justify-center gap-4 w-full">
          <button
            (click)="fileInput.click()"
            class="flex items-center gap-2 px-4 py-2 bg-white text-indigo-600 hover:text-indigo-900 transition-colors duration-200"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
              ></path>
            </svg>
            Change
          </button>
          <button
            class="flex items-center gap-2 px-4 py-2 bg-white text-indigo-600 hover:text-indigo-900 transition-colors duration-200"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"
              ></path>
            </svg>
            Crop
          </button>
          <button
            class="flex items-center gap-2 px-4 py-2 bg-white text-indigo-600 hover:text-indigo-900 transition-colors duration-200"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
              ></path>
            </svg>
            Rotate
          </button>
        </div>
        }

        <!-- Help text -->
        <p class="text-xs text-gray-400 text-center mt-2">
          For best results, use a high-quality square image (minimum 400×400
          pixels)
        </p>
      </div>
    </app-modal>

    <div class="toggle-box">
      <div class="toggle-panel toggle-left">
        <img src="/assets/logo (3).png" alt="logo" class="w-32 h-32" />
        <h1 class="text-white font-bold">Student Portal</h1>
        <p>Don't have an account?</p>
        <button class="btn" nz-button nzType="default" (click)="toggleActive()">
          Register
        </button>
      </div>

      <div class="toggle-panel toggle-right">
        <img src="/assets/logo (3).png" alt="logo" class="w-32 h-32" />
        <h1 class="text-white font-bold">Student Portal</h1>
        <p>Already have an account?</p>
        <button class="btn" nz-button nzType="default" (click)="toggleActive()">
          Login
        </button>
      </div>
    </div>
  </div>
</div>
